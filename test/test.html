<html>
<head>
    <title>transForm.js Test</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: #444;
            color: #FFF;
            font-family: Verdana, Geneva, 'DejaVu Sans', sans-serif;
        }

        .center {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

        .blockwrap {
            width: 100%;
            display: table;
        }

        .blockrow {
            display: table-row;
        }

        .block {
            display: table-cell;
            vertical-align: top;
            width: 50%;
            max-width: 400px;
            padding: 8px;
            background: #222;
        }

            .block input:not([type="radio"]):not([type="checkbox"]),
            .block textarea,
            .block select {
                width: 100%;
                margin-bottom: 8px;
            }

            .block button {
                width: 100%;
                height: 30px;
            }

        #output {
            height: 430px;
        }
    </style>
</head>
<body>
    <div class="center">
        <h1>transForm.js</h1>
        <div class="blockwrap">
            <div class="blockrow" id="options">
                <div class="block">
                    <label>Options</label><br/>
                    <input id="skipDisabled" type="checkbox" checked/><label for="skipDisabled">skipDisabled</label><br/>
                    <input id="skipFalsy" type="checkbox"/><label for="skipFalsy">skipFalsy</label><br/>
                    <input id="useIdOnEmptyName" type="checkbox"/><label for="useIdOnEmptyName">useIdOnEmptyName</label>
                </div>
                <div class="block">
                    <label>delimiter</label><input name="delimiter" type="text" value="."/>
                    <input id="triggerChange" type="checkbox"/><label for="triggerChange">triggerChange</label>
                </div>
            </div>
            All inputs have a change listener which makes the field green (not for checkboxes & radio's)
            <div class="blockrow">
                <div class="block">
                    <div id="myForm">
                        <label>Input</label><br />
                        <input name="input" value="JavaScript" /><br />
                        <label>Disabled input</label><br />
                        <input name="disabledinput" disabled="disabled" value="Computed field" /><br />
                        <label>Input without name with id</label><br />
                        <input id="inputwithId" value="got an idea?" /><br />
                        <label>Input without name without id</label><br />
                        <input value="Identify me" /><br />
                        <label>Checkboxes</label><br />
                        <input name="test.checkno" type="checkbox" />
                        <input name="test.checkdefault" type="checkbox" checked />
                        <input name="test.checkwithvalue" type="checkbox" value="myValue" checked /><br />
                        <label>Checkbox array</label><br />
                        <input name="test.checkarray[]" type="checkbox" value="checkbox1" checked />
                        <input name="test.checkarray[]" type="checkbox" value="checkbox2" checked />
                        <input name="test.checkarray[]" type="checkbox" value="checkbox3" /><br />
                        <label>Radiobuttons</label><br />
                        <input name="test.radio" type="radio" value="option1" checked />
                        <input name="test.radio" type="radio" value="option2" />
                        <input name="test.radio" type="radio" value="option3" /><br />
                        <label>Textarea</label><br />
                        <textarea name="test.textarea">default text</textarea><br />
                        <label>Select</label><br />
                        <select name="test.select">
                            <option value="javascript">JavaScript</option>
                            <option value="html" selected>HTML</option>
                            <option value="css">CSS</option>
                        </select><br />
                        <label>Multiselect</label><br />
                        <select name="test.multiselect" multiple>
                            <option value="javascript">JavaScript</option>
                            <option value="html" selected>HTML</option>
                            <option value="css" selected>CSS</option>
                            <option value="regex">RegEx</option>
                        </select><br />
                        <label>Input custom logic</label><br />
                        <input name="custom0" data-custom="foo" value="foo" /><br />
                        <input name="custom1" data-custom="bar" value="bar" /><br />
                        <button id="serialize">Serialize</button><br />
                        <button id="clear">Clear</button>
                    </div>
                </div>
                <div class="block">
                    <textarea id="output"></textarea>
                    <button id="deserialize">Deserialize</button>
                </div>
            </div>
        </div>
    </div>
    <script src="../src/transForm.js"></script>
    <script>
        (function () {
            var out = document.getElementById('output'),
                btnSerialize = document.getElementById('serialize'),
                btnDeserialize = document.getElementById('deserialize'),
                btnClear = document.getElementById('clear');
            btnSerialize.addEventListener('click', serialize);
            btnDeserialize.addEventListener('click', deserialize);
            btnClear.addEventListener('click', clear);

            var frm = document.querySelector('#myForm'),
                allInputs = frm.querySelectorAll('input,textarea,select');
            for (var i = allInputs.length; i--;)
                allInputs[i].addEventListener('change', function () {
                    var me = this;
                    me.style.backgroundColor = '#BADA55';
                    setTimeout(function () {
                        me.style.backgroundColor = '';
                    }, 1000);
                });

            function getOptions() {
                return transForm.serialize('#options', { useIdOnEmptyName: true });
            }

            function deserialize() {
                var myObject = JSON.parse(out.value);

                transForm.deserialize('#myForm', myObject, getOptions(), function (node, value) {
                    var cust = node.getAttribute('data-custom');
                    if (cust) {
                        node.value = value + value + value;
                        return true;
                    }
                });
            }

            function serialize() {
                var obj = transForm.serialize('#myForm', getOptions(), function (node) {
                    var cust = node.getAttribute('data-custom');
                    if (cust) {
                        return { name: node.name, value: cust }
                    }
                });

                out.value = JSON.stringify(obj, null, 4);
            }

            function clear() {
                transForm.clear('#myForm', getOptions());
            }

            serialize();
        }());
    </script>
</body>
</html>