!function(e,t){if("undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&"object"==typeof define.amd)define(t);else{var n=this[e];this[e]=t(),n&&(this[e].noConflict=n)}}("transForm",function(){function e(e,t){return void 0!==e&&(!t||e&&(!u(e,"array")||e.length))}function t(e,t){var n;switch(e.type&&e.type.toLowerCase()){case"radio":e.checked&&(n="on"===e.value||e.value);break;case"checkbox":n=!!e.checked&&("on"===e.value||e.value);break;case"select-multiple":n=[];for(var r=0,a=e.options.length;r<a;r++)e.options[r].selected&&n.push(e.options[r].value);break;case"file":n=e.value.split("\\").pop();break;case"button":case"submit":case"reset":break;default:n=e.value}return{name:t,value:n}}function n(e,t){var n;switch(e.type&&e.type.toLowerCase()){case"select-one":n=e.options[e.selectedIndex].text;break;case"select-multiple":n=[];for(var r=0,a=e.options.length;r<a;r++)e.options[r].selected&&n.push(e.options[r].text);break;default:n=e.textContent}return{name:t,value:n}}function r(e,t){for(var n=[],r=e.split(t),a=r.length,i=0;i<a;i++)for(var o=r[i].split("["),s=o.length,l=0;l<s;l++){var u=o[l];if(!u){if(0===l)continue;l!==s-1&&m("Undefined key is not the last part of the name > "+e)}u&&"]"===u[u.length-1]&&(u=u.slice(0,-1)),n.push(u)}return n}function a(e,t,n){if(!/\[\]$/.test(t.name)||t.value){for(var a=r(t.name,n),i=0,o=a.length;i<o;i++){var s=a[i];if(i===o-1)e[s]=t.value;else{var l=a[i+1];!l||u(l,"number")?(u(e[s],"array")||(e[s]=[]),i===o-2?e[s].push(t.value):(u(e[s][l],"object")||(e[s][l]={}),e=e[s][l]),i++):(u(e[s],"object")||(e[s]={}),e=e[s])}}return{pointer:e,prop:s}}}function i(e,t,n){if(e)for(var a=r(e,t),i=0,o=a.length;i<o;i++){if(!n)return;var s=n[a[i]];if(void 0===s||null===s)return;if(i===o-1)return s;var l=a[i+1];if(""===l)return s;if(u(l,"number")){if(i===o-2)return s[l];n=s[l],i++}else n=s}}function o(e,t){for(var n=e.length;n--;)if(e[n].toString()===t)return!0;return!1}function s(e,t,n){var r=!0;switch(e.type&&e.type.toLowerCase()){case"radio":t.toString()===e.value?e.checked=!0:r=!1;break;case"checkbox":e.checked=u(t,"array")?o(t,e.value):!0===t||t.toString()===e.value;break;case"select-multiple":if(u(t,"array"))for(var a=e.options.length;a--;)e.options[a].selected=o(t,e.options[a].value);else e.value=t;break;case"button":case"submit":case"reset":case"file":break;default:e.value=t}r&&n&&f(e,"change")}function l(e,t){switch(e.type&&e.type.toLowerCase()){case"select-one":e.selectedIndex=0;break;case"select-multiple":for(var n=e.options.length;n--;)e.options[n].selected=!1;break;case"radio":case"checkbox":e.checked&&(e.checked=!1);break;case"button":case"submit":case"reset":case"file":break;default:e.value=""}t&&f(e,"change")}function u(e,t){return Object.prototype.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()===t}function c(e){return-1!==b.inputs.indexOf(e.tagName.toLowerCase())}function f(e,t){var n;document.createEvent?((n=document.createEvent("HTMLEvents")).initEvent(t,!0,!0),e.dispatchEvent(n)):(n=document.createEventObject(),e.fireEvent("on"+t,n))}function d(e){var t=u(e,"string")?document.querySelector(e)||document.getElementById(e):e;return t||m("Element not found > "+e),t}function p(e,t,n){for(var r="["+b.attributeText+"],",a=0,i=b.inputs.length;a<i;a++)r+=b.inputs[a],t&&(r+=":not([disabled])"),n&&(r+=":not([readonly])"),r+=":not(["+b.attributeIgnore+"])",a!==i-1&&(r+=",");return e.querySelectorAll(r)}function v(e){if(!u(e,"object"))return b;var t,n={};for(t in b)n[t]=b[t];for(t in e)n[t]=e[t];return n}function m(e){throw new Error("transForm.js â™¦ "+e)}var b={attributeIgnore:"data-transform-ignore",attributeText:"data-transform-text",delimiter:".",deserializeClean:!0,inputs:["input","select","textarea"],skipDisabled:!0,skipFalsy:!1,skipReadOnly:!1,triggerChange:!1,useIdOnEmptyName:!0};return{serialize:function(r,i,o){for(var s,l,u,f,m=d(r),h=v(i),g=p(m,h.skipDisabled,h.skipReadOnly),k={},y=0,x=g.length;y<x;y++){if(s=g[y],l=null,f=s.getAttribute(b.attributeText)){var C=n(s,f);e(C.value,h.skipFalsy)&&a(k,C,h.delimiter)}c(s)&&(u=s.name||h.useIdOnEmptyName&&s.id)&&(o&&(l=o(s,u)),l||(l=t(s,u)),e(l.value,h.skipFalsy)&&a(k,l,h.delimiter))}return k},deserialize:function(e,t,n,r){var a=d(e),o=v(n),f=p(a,o.skipDisabled,o.skipReadOnly);if(!u(t,"object")){if(!u(t,"string"))return;try{t=JSON.parse(t)}catch(e){m("Passed string is not a JSON string > "+t)}}for(var h=0,g=f.length;h<g;h++){var k,y=f[h];if(c(y)){var x=i(y.name||o.useIdOnEmptyName&&y.id,o.delimiter,t);void 0!==x&&null!==x?r&&r(y,x)||s(y,x,o.triggerChange):o.deserializeClean&&l(y,o.triggerChange)}else(k=y.getAttribute(b.attributeText))&&(y.textContent=i(k,o.delimiter,t))}},clear:function(e,t){for(var n=d(e),r=v(t),a=p(n,r.skipDisabled,r.skipReadOnly),i=0,o=a.length;i<o;i++)l(a[i],r.triggerChange)},submit:function(e,t){var n=d(e);if(t){var r,a=n.querySelector('[type="submit"]');a||(r=!0,(a=document.createElement("button")).type="submit",a.style.display="none",n.appendChild(a)),f(a,"click"),r&&n.removeChild(a)}else u(n.submit,"function")?n.submit():m("The element is not a form element > "+e)},setDefaults:function(e){b=v(e)}}});